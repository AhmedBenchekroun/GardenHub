{% extends "gardenhub/_manage_base.html" %}
{% load gardenhub %}

{% block content %}
  <form class="ui form" action="" method="post">
    {% csrf_token %}
    <div class="field">
      <label>Name</label>
      <p class="description">The plot's name is probably a number, like 11. The plot should be clearly labeled with a sign.</p>
      <div class="ui input">
        <input type="text" name="title" placeholder="Enter a name&hellip;" value="{{ object.title }}">
      </div>
    </div>

    <div class="field">
      <label>Garden</label>
      <p class="description">Select the garden the plot is in.</p>

      <div class="ui fluid search selection dropdown">
        <input name="garden" type="hidden" value="{{ object.garden.id }}">
        <i class="dropdown icon"></i>
        <div class="default text">
          <i class="garden icon"></i>
          Select a Garden
        </div>
        <div class="menu">
          {% for garden in request.user.get_gardens %}
            <div class="item" data-value="{{ garden.id }}">{{ garden }}</div>
          {% endfor%}
        </div>
      </div>
    </div>

    <div class="field">
      <label>Gardeners</label>
      <p class="description">List the people who should manage this plot, or enter an email address to invite someone new.</p>
      <select name="gardener_emails" class="ui gardeners fluid search dropdown" multiple="">
        <option value="">Add gardeners&hellip;</option>
        {% for peer in object.gardeners|combine:request.user.get_peers %}
          <option value="{{ peer.email }}"{% if peer in object.gardeners.all %} selected{% endif %}>{% if peer.get_full_name %}{{ peer.get_full_name }}{% else %}{{ peer.email }}{% endif %}</option>
        {% endfor%}
      </select>
    </div>

    <div class="field">
      <label>Crops</label>
      <p class="description">List the crops growing on this plot.</p>
      <select name="crops" class="ui crops fluid search dropdown" multiple="">
        <option value="">Add crops&hellip;</option>
        {% for crop in form.crops.field.queryset %}
          <option value="{{ crop.id }}"{% if crop in object.crops.all %} selected{% endif %}>{{ crop.title }}</option>
        {% endfor%}
      </select>
    </div>

    <button class="large purple ui right floated button" type="submit">
      <i class="checkmark icon"></i>
      Update Plot
    </button>
  </form>
{% endblock %}

{% block extra_scripts %}
  <script>
    $('.ui.gardeners.dropdown')
      .dropdown({
        allowAdditions: true
      })
    ;
  </script>
{% endblock %}
